<!DOCTYPE html>
<html>
	<head>
		<!-- insert Mapbox GL library links here -->

<script src="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js"></script>
<link href="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css" rel="stylesheet" />
<script src ="https://cdn.jsdelivr.net/npm/luxon@1.25.0/build/global/luxon.min.js"/>
// <script src="luxon.js"></script>


		<style>
		#map {height: 80vh;}
		</style>
	</head>

	<body>
		<!-- create div for the map here -->
		<div id="map"></div>
			<div id="output"</div>



		<!-- JS code for the map goes here -->
		<script>
			//copy your access token here

			 mapboxgl.accessToken = "pk.eyJ1IjoiaC13YXJyZW4iLCJhIjoiY2tnemJmaG54MDQzNjJ3cnN2Mmg1MmF2cyJ9.AMeyJ2g8BQiBQ2ZyH9OyJw"; //"yourAccessTokenHere";

// document.getElementById("ouput").innerHTML="RespTime"
var DateTime=luxon.DateTime;


document.getElementById("output").innerHTML=DateTime
var time=getTime("RespTime")
		function timeToDecimal() {
		var arr = t.split(':');
		var dec = parseInt((arr[1]/6)*10, 10);

		return parseFloat(parseInt(arr[0], 10) + '.' + (dec<10?'0':'') + dec);

	};
		var map = new mapboxgl.Map({
			  container:"map", // HTML container id
			  style: "mapbox://styles/mapbox/streets-v11",  // style URL
			  center:[-122.4733, 47.255], // starting position as [lng, lat]
			  zoom: 10
				// starting zoom
		});

// Add GeoJSON layer
// on map load, run function to load the geojson

	map.on("load", function(){

			// map.addSource("districts",{
			// 	"type":"geojson",
			// 	"data":"districts.geojson"
			// });
			 // var dur= Duration.fromObject(properties.RespTime)
			 // dur.shiftTo("minutes", "seconds").toObject();
			// map.addLayer({
			// 	"id":"hoods",
			// 	"type":"fill",
			// 	"geometry-type":"Polygon",
			// 	"source":"districts",
			// 	"paint":{
			// 		"fill-color":{
			// 			"type":"categorical",
			// 			"property":"NAME",
			// 			"stops":[
			// 			["CENTRAL","red"],
			// 			["EASTSIDE","orange"],
			// 			["NEW TACOMA","yellow"],
			// 			["NORTH EAST","green"],
			// 			["NORTH END","blue"],
			// 			["SOUTH END","purple"],
			// 			["SOUTH TACOMA","grey"],
			// 			["WEST END","pink"]
			// 		]
			// 	}
			// }
			// });
		map.addSource("FireTable", {
				"type": "geojson",
				"data": "FireTimeString.geojson"
		});

				// "cluster":true,
				// "clusterMaxZoom":12,
				// "clusterRadius":75

	//  });
		map.addLayer({
			"id":"hotSpots",
			"type":"heatmap",
			"source":"FireTable",
			"maxzoom":9,
			"paint":{
				"heatmap-weight":[
						"interpolate",
						["linear"],
						["get","RespTime"],
						0,
						0,
						6,
						1
				],
				"heatmap-intensity":[
					"interpolate",
					["linear"],
					["zoom"],
					0,
					1,
					9,
					3
				],
				"heatmap-color":[
					"interpolate",
					["linear"],
					["heatmap-density"],
					0,
					"rgba(103,102,172,0)",
					0.2,
					"rgb(103,169,207)",
					0.4,
					"rgb(209,229,240)",
					0.6,
					"rgb(253,219,199)",
					0.8,
					"rgb(239,138,98)",
					1,
					"rgb(178,24,43)"
				],
				"heatmap-radius":[
					"interpolate",
					["linear"],
					["zoom"],
					7,
					1,
					9,
					0
				]

		},
	});
	map.addLayer({
		"id":"fireCalls",
		"type":"circle",
		"source":"FireTable",
		"minzoom":7,
		"paint":{
				"circle-radius":[
					"interpolate",
					["linear"],
					["zoom"],
					7,
					["interpolate",["linear"],
						["get","RespTime"],1,1,6,4],
						16,
					["interpolate",["linear"],
						["get","RespTime"],1,5,6,50]			  ],
				"circle-color":[
					"interpolate",
					["linear"],
					["get","RespTime"],
						1,
						"rgba(33,102,172,0)",
						2,
						"rgb(103,169,207)",
						3,
						"rgb(209,229,240)",
						4,
						"rgb(253,219,199)",
						5,
						"rgb(239,138,98)",
						6,
						"rgb(178,24,43)"
				],
				"circle-stroke-color":"white",
				"circle-stroke-width":1,
						"circle-opacity":[
							"interpolate",
							["linear"],
							["zoom"],
							7,
							0,
							8,
							1
						]
					}
				},
			);
	});


	// 	map.addLayer({
	// 			"id": "clusters",
	// 			"type": "circle",
	// 			"source": "FireTable",
	// 			"paint": {
	// 				"circle-color":[
	// 					"step",["get","point_count"],
	// 					"#51bbd6",
	// 					75,
	// 					"#f1f075",
	// 					300,
	// 					"#f28cb1",
	// 					500,
	//
	// 					"grey"
	// 				],
	// 			}
	// 	});
	// 	map.addLayer({
	// 			"id":"cluster-count",
	// 			"type":"symbol",
	// 			"source":"FireTable",
	// 			"filter":["has","point_count"],
	// 			"layout":{
	// 					"text-field":"{point_count_abbreviated}",
	// 					"text-font":["DIN Offc Pro Medium", "Arial Unicode MS Bold"],
	// 					"text-size":12
	// 			}
	// 	});
	// 	map.addLayer({
	// 			"id":"unclustered-point",
	// 			"type":"circle",
	// 			"source":"FireTable",
	// 			"filter":["!",["has","point_count"]],
	// 			"paint":{
	// 					"circle-color":"#11b4da",
	// 					"circle-radius":4,
	// 					"circle-stroke-width":1,
	// 					"circle-stroke-color":"#fff"
	// 			}
	// 	});
	// 	map.on("click","clusters",function(e){
	// 			var features = map.queryRenderedFeatures(e.point,
	// 				{
	// 					layers:["clusters"]
	//
	// 			});
	// 			var clusterId= features[0].properties.cluster_id;
	// 			map.getSource("FireTable").getClusterExpanssionZoom(
	// 				clusterId,
	// 				function(err, zoom){
	// 					if (err)return;
	//
	// 					map.easeTo({
	// 						"center":
	// 							features[0].geometry.coordinates,
	// 							"zoom":"zoom"
	// 					});
	// 				}
	// 			);
	// 	});
	// });


//
// 			map.on("click", "fireTime", function (e) {
// 			new mapboxgl.Popup()
// 			.setLngLat(e.lngLat)
// 			.setHTML("Date: <b>" +e.features[0].properties.RespTime + "</b>")
// 			.addTo(map);
// 			});
//
// 			map.on("mouseenter", "fireTime", function () {
// map.getCanvas().style.cursor = "pointer";
// });
// //
// // // Change it back to a pointer when it leaves.
// 				map.on("mouseleave", "fireTime", function () {
// map.getCanvas().style.cursor = "pointer";
// });

		</script>
		<p id="output"></p>
	</body>
</html>
